name: 'DX Create Deployment'
description: 'Create a deployment record in DX platform'
author: 'Luscii'

inputs:
  dx_instance:
    description: 'DX instance name (e.g., "luscii" for luscii.getdx.net)'
    required: true
  bearer:
    description: 'Bearer token for authentication'
    required: true
  service:
    description: 'Service name for the deployment'
    required: true
  repository:
    description: 'Repository name in format "owner/repo"'
    required: false
    default: ${{ github.repository }}
  commit_sha:
    description: 'Commit SHA for the deployment'
    required: false
    default: ${{ github.sha }}
  deployed_at:
    description: 'Deployment timestamp (Unix timestamp). Defaults to current time if not provided'
    required: false
  reference_id:
    description: 'Unique identifier for the deployment. If not provided, a random UUID is generated by DX'
    required: false
  source_url:
    description: 'External URL containing more information about your deployment. This will be displayed in the UI'
    required: false
  source_name:
    description: 'The source for the deployment to help differentiate and compare data from different deploy systems'
    required: false
  metadata:
    description: 'JSON object with additional data about your deployment that you define (e.g., {"version": "v1.11.23"})'
    required: false
  integration_branch:
    description: 'Set this if you are using a branch to integrate changes before merging to a release branch'
    required: false
  success:
    description: 'Whether the deployment was successful (true/false)'
    required: false
  environment:
    description: 'Environment name. Defaults to "production" if not specified'
    required: false
  merge_commit_shas:
    description: 'JSON array of commit SHA strings for attributing deploys to specific pull requests (e.g., ["a0e61dfff93b", "07788cacf2c"])'
    required: false

runs:
  using: 'node20'
  main: 'dist/index.js'

branding:
  icon: 'upload-cloud'
  color: 'blue'